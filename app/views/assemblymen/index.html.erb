<%= render "shared/second-header" %>
<% breadcrumb :council, @council %>
<div class='main'>
  <%= render 'shared/breadclumbs' %>
  <%= link_to '議員検索', "/prefectures/#{params[:prefecture_id]}/councils/#{params[:id]}/search", class: 'search-btn' %>
  <h1 class='prefecture-name'><%= @council.name %>のデータ</h1>
  <div class='chart-area'>
    <div class='chart-content'>
      <p>男女比</p>
      <%= pie_chart @assemblymen.group(:sex).count, height: '150px', legend: 'bottom', donut: true, suffix: '人' %>
    </div>
    <div class='chart-content'>
      <p>所属党派・会派</p>
      <%= pie_chart @assemblymen .group(:faction).count, height: '150px', legend: 'bottom', donut: true, suffix: '人' %>
    </div>
  </div>
  <p class='reference'>※グラフは<%= @council.name %>ホームページの情報を基に作成しています。</p>
  <% if @assemblymen %>
    <div class='assemblymen-list'>
      <% @assemblymen.each do |assemblyman| %>
          <a href=<%= "assemblymen/#{assemblyman.id}" %>>
        <div class='assemblyman-content'>
            <div class='img-background'>
              <% if assemblyman.img_url %>
                <%= image_tag assemblyman.img_url, class: 'assemblyman-img' %>
                <% if @council.name.include?('知事・市長') %>
                  <% if assemblyman.position.include?('知事') %>
                    <p class='reference'>© <%= assemblyman.position.delete('知事') %></p>
                  <% elsif assemblyman.position.include?('長') %>
                    <p class='reference'>© <%= assemblyman.position.delete('長') %></p>
                  <% end %>
                <% else %>
                  <p class='reference'>© <%= assemblyman.council.name %></p>
                <% end %>
              <% else %>
                <%= image_tag 'assemblyman-alt-img.png', class: 'assemblyman-img' %>
              <% end %>
            </div>
            <div class='profile-content'>
              <div class='council-name'>
                <%= assemblyman.name %>
              </div>
              <% if assemblyman.position %>
                <div class='profile-faction'>
                  <%= assemblyman.position %>
                </div>
              <% end %>
              <% if assemblyman.faction %>             
                <div class='profile-faction'>
                  <%= assemblyman.faction %>
                </div>
              <% end %>
            </div>
        </div>
          </a>
      <% end %>
    </div>
  <% else %>
    <div class='coming-soon'>
      <h2>Comming Soon!!</h2>
      <p>更新までお待ちください。</p>
    </div>
  <% end %>
</div>
<%= render 'shared/footer' %>

<%= render "shared/header" %>
<div class='main'>
  <div class='assemblyman-show-profile'>
    <div class='background'>
      <% if @assemblyman.img_url %>
        <%= image_tag @assemblyman.img_url, class: 'assemblyman-show-img' %>
      <% else %>
        <%= image_tag 'assembly-img-dammy.png', class: 'assemblyman-img' %>
      <% end %>
    </div>
    <div class='profile-content'>
      <p class='assemblyman-name'><%= @assemblyman.name %></p>
      <div class='profile-wrap'>
        <p class='profile-heading'>生年月日</p>
        <p class="profile-text"><%= l @assemblyman.birth_of_date %></p>
      </div>
      <div class='profile-wrap'>
        <p class='profile-heading'>会派</p>
        <p class="profile-text"><%= @assemblyman.faction %></p>
      </div>
      <div class='profile-wrap'>
        <p class='profile-heading'>当選回数</p>
        <p class="profile-text"><%= @assemblyman.number_of_wins %> 回</p>
      </div>
      <div class='profile-wrap'>
        <p class='profile-heading'>職業</p>
        <p class="profile-text"><%= @assemblyman.job %></p>
      </div>
    </div>
  </div>
  <%= link_to '議員一覧へ戻る',  "/prefectures/#{params[:prefecture_id]}/councils/#{params[:council_id]}", class: 'back-to-assemblymen-list'%>

    <%# コメント投稿フォーム %>
  <div class="assemblymen-comments">
    <% if user_signed_in? %>
      <%= form_with url: prefecture_council_assemblyman_comments_path(assemblyman_id: params[:id]), local: true do |f| %>
        <div>
          <%= f.text_field :comment , placeholder: 'コメントを書く', class: 'field' %>
            <%= f.submit "送信する", class: 'form__btn' %>
        </div>
      <% end %>
    <% else %>
      <p class='notes'>コメントの投稿には<a href="#">ユーザー登録</a>が必要です</p>
    <% end %> 

    <%# コメントを一覧表示 %>
    <ul class="comments-lists">
      <% if @comments.find_by(assemblyman_id: params[:id]) %>
        <% @comments.each do |comment| %> 
          <li class="comments-list">
            <div class='comment-user'>
              <%= comment.user.nickname %>
            </div>
            <span class='comment-text'><%= comment.comment %></span>
          </li>
        <% end %>
      <% else  %>
        <div class='notes'>コメントはまだありません。</div>
      <% end %>
    </ul>
  </div>
  
</div>
<%= render 'shared/footer' %>